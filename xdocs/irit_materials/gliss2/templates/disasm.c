/* Generated by gep ($(date)) copyright (c) 2008 IRIT - UPS */

#include <string.h>
#include <stdio.h>
#include <$(proc)/api.h>
#include <$(proc)/id.h>
#include <$(proc)/macros.h>
#include <$(proc)/grt.h>


/* useful macros */
/*#define __GLISS_MASK(n, e) ((e) & ((1LL << n) - 1))*/
#define __GLISS_MASK32(n, e) ((n)==32 ? (e) : ((e) & ((1 << n) - 1)))
#define __GLISS_MASK64(n, e) ((n)==64 ? (e) : ((e) & ((1LL << n) - 1)))
#define __GLISS_EXTS(n, e) (((e) << n) >> n)


typedef void (*disasm_t)(char *buffer, $(proc)_inst_t *inst);


/* functions */
static void disasm_unknown(char *buffer, $(proc)_inst_t *inst) {
	strcpy(buffer, "<unknown>");
}

$(foreach instructions)
static void disasm_$(IDENT)(char *__buffer, $(proc)_inst_t *inst) {
	$(disassemble)
}
$(end)

/* table */
static disasm_t disasm_tab[] = {
	disasm_unknown$(foreach instructions),
	disasm_$(IDENT)$(end)
};

/**
 * Disassemble the given instruction.
 * @param buffer	Buffer to write in.
 * @param inst		Decode instruction.
 */
void $(proc)_disasm(char *buffer, $(proc)_inst_t *inst) {
	disasm_tab[inst->ident](buffer, inst);
}
